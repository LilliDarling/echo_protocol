 Here's the complete list of changes needed:

  ---
  Files to CREATE

  | File                                                  | Purpose                                               |
  |-------------------------------------------------------|-------------------------------------------------------|
  | lib/services/recovery_phrase_service.dart             | BIP39 mnemonic generation, validation, key derivation |
  | lib/features/auth/recovery_phrase_display_screen.dart | Show 12 words during signup                           |
  | lib/features/auth/recovery_phrase_verify_screen.dart  | Verify user saved phrase (enter words back)           |
  | lib/features/auth/recovery_entry_screen.dart          | Enter phrase when keys missing (recovery flow)        |

  ---
  Files to MODIFY

  | File                                  | Changes                                                                                                                                                                                              |
  |---------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
  | pubspec.yaml                          | Add bip39 package dependency                                                                                                                                                                         |
  | lib/services/encryption.dart          | Replace generateKeyPair() with generateKeyPairFromSeed(Uint8List seed) - remove random generation                                                                                                    |
  | lib/services/auth.dart                | - Remove _generateAndStoreKeys() random key logic- Add mnemonic flow to signup- Add recovery flow to signin when keys missing- Modify _loadUserKeys() to trigger recovery screen instead of throwing |
  | lib/services/secure_storage.dart      | Add storePublicKeyHash() / getPublicKeyHash() for recovery verification                                                                                                                              |
  | lib/features/auth/sign_up_screen.dart | Navigate to recovery phrase screens after account creation                                                                                                                                           |
  | lib/features/auth/sign_in_screen.dart | Handle recovery flow navigation when keys missing                                                                                                                                                    |

  ---
  Files to REVIEW (may need minor updates)

  | File                                           | Why                                                      |
  |------------------------------------------------|----------------------------------------------------------|
  | lib/services/device_linking.dart               | Verify it still works with new key derivation            |
  | lib/services/partner_service.dart              | No changes needed - uses keys the same way               |
  | lib/features/messages/conversation_screen.dart | No changes - already has error handling for missing keys |

  ---
  Code to REMOVE

  | Location             | What to Remove                                                       |
  |----------------------|----------------------------------------------------------------------|
  | encryption.dart      | Random key generation in generateKeyPair() (replace with seed-based) |
  | auth.dart            | _generateAndStoreKeys() random generation logic                      |
  | partner_service.dart | _verifyInviteSignature() - already marked as TODO for cloud function |

  ---
  New Flow Summary

  SIGN UP:
    Create Firebase Account
           ↓
    Generate 12-word mnemonic
           ↓
    Display Recovery Phrase Screen
           ↓
    Verify Phrase Screen (enter words 3, 7, 11)
           ↓
    Derive keys from mnemonic
           ↓
    Store keys in secure storage
           ↓
    Create Firestore user document
           ↓
    Done

  SIGN IN (keys exist):
    Firebase Sign In → Load keys → Done

  SIGN IN (keys missing):
    Firebase Sign In
           ↓
    Keys not found
           ↓
    Recovery Entry Screen
           ↓
    Enter 12 words
           ↓
    Derive keys from mnemonic
           ↓
    Verify public key matches Firestore
           ↓
    Store keys in secure storage
           ↓
    Done (old messages decryptable!)

  ---
  Estimated Scope

  - New code: ~400-500 lines
  - Modified code: ~100-150 lines
  - Removed code: ~50 lines